<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Discontinuous Galerkin Library: dg::CG&lt; Vector &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <!--My own title area-->
  <ul class="tablist"> 
      <li><a href="../../../index.html">/</a><li>
    <li><a href="../../../inc/dg/html/index.html">DG lib</a></li>
    <li><a href="../../../inc/file/html/index.html">FILE lib</a></li>
    <li><a href="../../../inc/toefl/html/index.html">TOEFL lib</a></li>
    <li><a href="../../../src/solovev/html/index.html">SOLOVEV lib</a></li>
    <li><a href="../../../src/feltor/html/index.html">FELTOR code</a></li>
    <li><a href="../../../src/feltor2D/html/index.html">FELTOR2D code</a></li>
    <li><a href="../../../src/innto/html/index.html">INNTO code</a></li>
  </ul>
  <!--End My own title area-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Discontinuous Galerkin Library
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">Discontinuous Galerkin numerical methods and container free numerical algorithms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classdg_1_1_c_g.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classdg_1_1_c_g-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">dg::CG&lt; Vector &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__algorithms.html">Numerical schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functor class for the preconditioned conjugate gradient method to solve </p>
<p class="formulaDsp">
\[ Ax=b\]
</p>
<p>.  
 <a href="classdg_1_1_c_g.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cg_8h_source.html">cg.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a1ef5a42ac2f35b465a9b5e5d2293d572"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ef5a42ac2f35b465a9b5e5d2293d572"></a>
typedef VectorTraits&lt; Vector &gt;<br class="typebreak"/>
::<a class="el" href="classdg_1_1_c_g.html#a1ef5a42ac2f35b465a9b5e5d2293d572">value_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdg_1_1_c_g.html#a1ef5a42ac2f35b465a9b5e5d2293d572">value_type</a></td></tr>
<tr class="memdesc:a1ef5a42ac2f35b465a9b5e5d2293d572"><td class="mdescLeft">&#160;</td><td class="mdescRight">value type of the Vector class <br/></td></tr>
<tr class="separator:a1ef5a42ac2f35b465a9b5e5d2293d572"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2c8ea3ee27e6a0081f2694a69d5ef78b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdg_1_1_c_g.html#a2c8ea3ee27e6a0081f2694a69d5ef78b">CG</a> (const Vector &amp;copy, unsigned max_iter)</td></tr>
<tr class="memdesc:a2c8ea3ee27e6a0081f2694a69d5ef78b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve memory for the pcg method.  <a href="#a2c8ea3ee27e6a0081f2694a69d5ef78b">More...</a><br/></td></tr>
<tr class="separator:a2c8ea3ee27e6a0081f2694a69d5ef78b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b59194ed8198858e1eb969059559a4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdg_1_1_c_g.html#a5b59194ed8198858e1eb969059559a4e">set_max</a> (unsigned new_max)</td></tr>
<tr class="memdesc:a5b59194ed8198858e1eb969059559a4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the maximum number of iterations.  <a href="#a5b59194ed8198858e1eb969059559a4e">More...</a><br/></td></tr>
<tr class="separator:a5b59194ed8198858e1eb969059559a4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6ddea9c0e7b7f2149722ef25cc9dd8"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdg_1_1_c_g.html#a6c6ddea9c0e7b7f2149722ef25cc9dd8">get_max</a> () const </td></tr>
<tr class="memdesc:a6c6ddea9c0e7b7f2149722ef25cc9dd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current maximum number of iterations.  <a href="#a6c6ddea9c0e7b7f2149722ef25cc9dd8">More...</a><br/></td></tr>
<tr class="separator:a6c6ddea9c0e7b7f2149722ef25cc9dd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc452436c95a758207bc35cec53909f"><td class="memTemplParams" colspan="2">template&lt;class Matrix , class Preconditioner &gt; </td></tr>
<tr class="memitem:a8dc452436c95a758207bc35cec53909f"><td class="memTemplItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classdg_1_1_c_g.html#a8dc452436c95a758207bc35cec53909f">operator()</a> (Matrix &amp;A, Vector &amp;x, const Vector &amp;b, Preconditioner &amp;P, <a class="el" href="classdg_1_1_c_g.html#a1ef5a42ac2f35b465a9b5e5d2293d572">value_type</a> eps=1e-12, value_type nrmb_correction=1)</td></tr>
<tr class="memdesc:a8dc452436c95a758207bc35cec53909f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the system A*x = b using a preconditioned conjugate gradient method.  <a href="#a8dc452436c95a758207bc35cec53909f">More...</a><br/></td></tr>
<tr class="separator:a8dc452436c95a758207bc35cec53909f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class Vector&gt;<br/>
class dg::CG&lt; Vector &gt;</h3>

<p>Functor class for the preconditioned conjugate gradient method to solve </p>
<p class="formulaDsp">
\[ Ax=b\]
</p>
<p>. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Vector</td><td>The Vector class: needs to model Assignable</td></tr>
  </table>
  </dd>
</dl>
<p>The following 3 pseudo - BLAS routines need to be callable </p>
<ul>
<li>value_type dot = <a class="el" href="group__blas1.html#gade540580ce83e615dcb8e2210689bb32" title="Euclidean dot product between two Vectors. ">dg::blas1::dot( const Vector&amp;, const Vector&amp;)</a>; </li>
<li><a class="el" href="group__blas1.html#ga6ee5b940147ba6b71e1fe1fc538e9459" title="Modified BLAS 1 routine axpy. ">dg::blas1::axpby()</a>; with the Vector type </li>
<li><a class="el" href="group__blas2.html#ga268c50e488c18db3dc5be1d1934eb7b2" title="Symmetric Matrix Vector product. ">dg::blas2::symv(Matrix&amp; m, Vector1&amp; x, Vector2&amp; y )</a>; with the Matrix type </li>
<li>value_type dot = <a class="el" href="group__blas2.html#gaeb8a93cac85646f2173160afd2a79d53" title="General dot produt. ">dg::blas2::dot( )</a>; with the Preconditioner type </li>
<li><a class="el" href="group__blas2.html#ga7f66ae102c9c093cdc0877a989fd82b3" title="Symmetric Matrix Vector product. ">dg::blas2::symv( )</a>; with the Preconditioner type</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Conjugate gradients might become unstable for positive semidefinite matrices arising e.g. in the discretization of the periodic laplacian </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2c8ea3ee27e6a0081f2694a69d5ef78b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Vector&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdg_1_1_c_g.html">dg::CG</a>&lt; Vector &gt;::<a class="el" href="classdg_1_1_c_g.html">CG</a> </td>
          <td>(</td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>copy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reserve memory for the pcg method. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">copy</td><td>A Vector must be copy-constructible from copy </td></tr>
    <tr><td class="paramname">max_iter</td><td>Maximum number of iterations to be used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a6c6ddea9c0e7b7f2149722ef25cc9dd8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Vector&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classdg_1_1_c_g.html">dg::CG</a>&lt; Vector &gt;::get_max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the current maximum number of iterations. </p>
<dl class="section return"><dt>Returns</dt><dd>the current maximum </dd></dl>

</div>
</div>
<a class="anchor" id="a8dc452436c95a758207bc35cec53909f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Vector&gt; </div>
<div class="memtemplate">
template&lt;class Matrix , class Preconditioner &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classdg_1_1_c_g.html">dg::CG</a>&lt; Vector &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype">Matrix &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Preconditioner &amp;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdg_1_1_c_g.html#a1ef5a42ac2f35b465a9b5e5d2293d572">value_type</a>&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-12</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdg_1_1_c_g.html#a1ef5a42ac2f35b465a9b5e5d2293d572">value_type</a>&#160;</td>
          <td class="paramname"><em>nrmb_correction</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the system A*x = b using a preconditioned conjugate gradient method. </p>
<p>The iteration stops if \( ||Ax|| &lt; \epsilon( ||b|| + C) \) where \(C\) is a correction factor to the absolute error </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Matrix</td><td>The matrix class: no requirements except for the BLAS routines </td></tr>
    <tr><td class="paramname">Preconditioner</td><td>no requirements except for the blas routines. Thus far the dg library provides only diagonal preconditioners, which should be enough if the result is extrapolated from previous timesteps. In every iteration the following BLAS functions are called: <br/>
 symv 1x, dot 1x, axpby 2x, Prec. dot 1x, Prec. symv 1x </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>A symmetric positive definit matrix </td></tr>
    <tr><td class="paramname">x</td><td>Contains an initial value on input and the solution on output. </td></tr>
    <tr><td class="paramname">b</td><td>The right hand side vector. x and b may be the same vector. </td></tr>
    <tr><td class="paramname">P</td><td>The preconditioner to be used </td></tr>
    <tr><td class="paramname">eps</td><td>The relative error to be respected </td></tr>
    <tr><td class="paramname">nrmb_correction</td><td>Correction factor C for norm of b</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of iterations used to achieve desired precision </dd></dl>

</div>
</div>
<a class="anchor" id="a5b59194ed8198858e1eb969059559a4e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Vector&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classdg_1_1_c_g.html">dg::CG</a>&lt; Vector &gt;::set_max </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>new_max</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the maximum number of iterations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_max</td><td>New maximum number </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/matthias/feltor/inc/dg/<a class="el" href="cg_8h_source.html">cg.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedg.html">dg</a></li><li class="navelem"><a class="el" href="classdg_1_1_c_g.html">CG</a></li>
    <li class="footer">Generated on Mon Mar 16 2015 23:45:07 for Discontinuous Galerkin Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
